# Система управления банковскими картами

Выполнение тестового задания на тему "Разработка системы управления банковскими картами". Техническое задание: https://docs.google.com/document/d/1IDT0YuytAV38C5UrbmVOnhMgv3vOxy9IPaR-XtIoXbA.

## Используемые технологии

- Spring Boot/Security/Data JPA
- СУБД PostgreSQL, pgAdmin 4, Liquibase для управления миграциями
- Spring Profiles для разделения конфигурации
- JWT
- Maven
- Lombok
- Docker/Docker Compose
- VirtualBox/Ubuntu Server для развертывания БД на время разработки
- Postman
- MockMvc/JUnit
- OpenAPI/Swagger

## Выполненные работы

### Безопасность

Реализовано разделение на роли: администратор/пользователь. Аутентификация с использованием пары email/пароль (Basic Auth), авторизация с использованием JWT-токенов (access, refresh). Иное взаимодействие с API, кроме эндпоинта аутентификации, с использованием Basic Auth запрещено (JWT-only). Номера карт в базе данных хранятся в зашифрованном виде (AES). Для упрощения процедуры тестирования необходимые ключи помещены в файл `.env`. Механизм защиты от CSRF-атак не отключался.

### Функциональные возможности

Функциональные возможности реализованы согласно технического задания. Доступные API-эндпоинты описаны с помощью Swagger.

### Конфигурация

На этапе разработки в качестве сервера БД использовалась виртуальная машина с установленной операционной системой Ubuntu Server и СУБД PostgreSQL. На этапе тестирования использовалась СУБД PostgreSQL в контейнере Docker. Для разделения конфигурации этапов разработки и тестирования использовались профили Spring.

## Развертывание и тестирование

### Развертывание

Для развертывания приложения с использованием Docker Compose выполните следующие команды:

- Клонируйте репозиторий и перейдите в директорию проекта:
```
git clone https://github.com/DMCustoms/Cards.git
cd Cards
```
- Выполните команду запуска Docker Compose:
```
docker compose up -d
```
После завершения создания образов и старта контейнеров, контейнер с приложением станет доступен по URL http://172.16.238.2:8080. 

### Тестирование

В целях обеспечения возможности тестирования, база данных при создании заполняется начальными данными:
- Таблица `cards` заполняется списком карт. Для проведения интеграционного тестирования предусматривается включение в таблицу карты, не имеющей владельца и карты, имеющей статус "заблокирована"
- Таблица `users` заполняется списком пользователей. Для обеспечения функционирования приложения создается одна учетная запись, имеющая роль "администратор"
- Картам случайным образом назначаются владельцы. Для проведения интеграционного тестирования создаются карты, имеющие предопределенных владельцев

Список созданных пользователей приводится в каталоге `dev` репозитория, файл `users.csv`. Коллекция Postman для тестирования основных возможностей приложения также приводится в каталоге `dev` репозитория.


